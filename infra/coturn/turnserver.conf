# Coturn TURN Server Configuration for VibeSpeak
# Works for local development and production
#
# For production, set these environment variables:
#   COTURN_EXTERNAL_IP - Your server's public IP
#   COTURN_SECRET - Shared secret for time-limited credentials

# ============================================
# NETWORK CONFIGURATION
# ============================================

# Listening ports (standard TURN ports)
listening-port=3478
tls-listening-port=5349

# Listen on all interfaces (required for Docker)
listening-ip=0.0.0.0

# Relay addresses - will be set by environment variable
# relay-ip=0.0.0.0

# External IP (set via COTURN_EXTERNAL_IP env var)
# external-ip=YOUR_PUBLIC_IP

# Server identification
server-name=vibespeak
realm=vibespeak

# ============================================
# AUTHENTICATION
# ============================================

# Option 1: Static credentials (development/simple)
# Username: vibespeak, Password: vibespeak123
user=vibespeak:vibespeak123

# Option 2: Time-limited credentials via secret (RECOMMENDED for production)
# The secret is set via COTURN_SECRET environment variable
# This allows the API to generate temporary credentials for clients
# static-auth-secret=YOUR_SECRET_HERE

# ============================================
# RELAY PORTS
# ============================================

# Port range for relay connections
min-port=49152
max-port=49200

# ============================================
# TLS/DTLS CONFIGURATION (production)
# ============================================

# Enable TLS for secure connections
# Uncomment and set paths in production:
# cert=/etc/ssl/certs/vibespeak.crt
# pkey=/etc/ssl/private/vibespeak.key

# DTLS for WebRTC
dtls-listening-port=5349

# ============================================
# SECURITY OPTIONS
# ============================================

# Enable long-term credential mechanism
lt-cred-mech

# Disable CLI (security)
no-cli

# Reject peers with mismatched addresses
# check-origin-consistency

# ============================================
# PERFORMANCE OPTIONS
# ============================================

# Enable UDP relay
relay

# Maximum bandwidth per session (0 = unlimited)
# max-bps=0

# Total quota (0 = unlimited)
# total-quota=0

# ============================================
# LOGGING
# ============================================

# Log to stdout (works well with Docker)
log-file=stdout

# Verbose logging (disable in production)
# verbose

# Log binding information
log-binding

# ============================================
# FINGERPRINT
# ============================================

# Use fingerprint in TURN responses
fingerprint

# ============================================
# ADDITIONAL OPTIONS
# ============================================

# Stale nonce timeout (seconds)
stale-nonce=600

# Enable mobility with ICE (for better NAT traversal)
mobility

# Allow TURN to relay to loopback addresses (useful for testing)
# allow-loopback-peers
